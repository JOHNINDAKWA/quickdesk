/* =========================================================
   QuickDesk — MyTickets (UX pass)
   - Sticky first/last columns (checkbox + 3-dots)
   - Constrained Subject; earlier truncation
   - Horizontal scroll on smaller laptops
   - Centered badge text
   ========================================================= */

/* ---------- Top bar (unchanged, kept concise) ---------- */
.mytickets-root {
  display: grid;
  gap: 12px;
}
.mytickets-topbar {
  display: grid;
  grid-template-columns: 1fr auto;
  align-items: center;
  gap: 12px;
  padding: 10px;
  border: 1px solid var(--border);
  background: var(--surface-1);
}
.topbar__search {
  display: flex;
  align-items: center;
  gap: 8px;
  background: var(--surface-2);
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  padding: 8px 10px;
}
.topbar__icon {
  opacity: 0.6;
}
.topbar__search input {
  width: 100%;
  border: 0;
  background: transparent;
  color: var(--text);
  outline: none;
  font-size: 14px;
}
.topbar__right {
  display: inline-flex;
  align-items: center;
  gap: 10px;
}
.topbar__sort {
  display: inline-flex;
  gap: 8px;
  align-items: center;
}
.topbar__sort label {
  font-size: 12px;
  color: var(--text-muted);
}
.topbar__sort select {
  height: 36px;
  padding: 6px 10px;
  font-size: 13px;
  border-radius: var(--radius-lg);
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text);
}
.topbar__filtersBtn {
  display: none;
}

/* ---------- Bulk bar ---------- */
.mytickets-bulkbar {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 8px 10px;
  font-size: 13px;
  border: 1px solid var(--border);
  background: color-mix(in oklab, var(--brand-weak), var(--surface-1) 65%);
  box-shadow: var(--shadow-1);
}
.mytickets-bulkbar__actions {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}
.btn-group {
  display: inline-flex;
  gap: 6px;
}

/* ---------- Main split ---------- */
.mytickets-main {
  display: grid;
  grid-template-columns: minmax(0, 1fr) 320px;
  gap: 12px;
}
.mytickets-filterPanel {
  border: 1px solid var(--border);
  background: var(--surface-1);
  padding: 12px;
}

/* ---------- Table shell ---------- */
.mytickets-table {
  /* One source of truth for columns. Constrain Subject earlier. */
  --cols: 38px 110px minmax(220px, 1.45fr) 96px 110px 130px 160px 110px 120px
    110px 40px;
  /* Force horizontal scroll when container is narrower. */
  --minw: 1160px;

  padding: 0;
  overflow-x: auto;
  overflow-y: visible; 
  border: 1px solid var(--border);
  background: var(--surface-1);
}

/* Compact typography */
.mytickets-table,
.mytickets-table .cell,
.mytickets-table .badge {
  font-size: 13px;
}

/* Header + rows use the same grid */
.tbl-head,
.row {
  display: grid;
  grid-template-columns: var(--cols);
  align-items: center;
  column-gap: 8px;
  min-width: var(--minw); /* makes the grid wider than container -> scroll */
}

/* Sticky header */
.tbl-head {
  position: sticky;
  top: 0;
  z-index: 2;
  padding: 8px 10px;
  border-bottom: 1px solid var(--border);
  background: color-mix(in oklab, var(--surface-1), var(--surface-2) 50%);
  backdrop-filter: blur(6px);
}
.tbl-head .cell {
  font-size: 11px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

/* Make Ref sticky left too (optional) */
.tbl-head .cell.ref,
.row .cell.ref {
  position: sticky;
  left: 38px; /* sits after the checkbox column (38px) */
  z-index: 2;
  background: var(--surface-1);
  border-right: 1px solid var(--border);
  padding-left: 8px;
}


/* Rows */
.tbl-body .row {
  padding: 8px 10px;
  min-height: 42px;
  border-top: 1px solid var(--border);
  background: var(--surface-1);
}
.tbl-body .row:hover {
  background: var(--surface-2);
}

.tbl-body .row:has(.rowmenu) {
  position: relative;     /* create stacking context */
  z-index: 50;            /* above other sticky cells */
}
.row.is-selected {
  box-shadow: inset 0 0 0 2px color-mix(in oklab, var(--brand), transparent 60%);
  background: color-mix(in oklab, var(--brand-weak), var(--surface-1) 72%);
}


.tbl-head { background: var(--surface-1); }
/* ---------- Sticky first & last columns (checkbox + 3-dots) ---------- */
.tbl-head .cell.sel,
.row .cell.sel {
  position: sticky;
  left: 0;
  z-index: 2;
  background: var(--surface-1);
  border-right: 1px solid var(--border);
  box-shadow: none; /* remove the "pane" look */
}
.tbl-head .cell.more,
.row .cell.more {
  position: sticky;
  right: 0;
  z-index: 3;
  background: var(--surface-1);
  border-left: 1px solid var(--border);
  box-shadow: none; /* remove heavy glow that made UPDATED look detached */
}
/* Cells */
.cell.sel {
  display: flex;
  align-items: center;
  justify-content: center;
}
.cell.ref.mono {
  font-weight: 600;
}
.link-plain {
  color: inherit;
  text-decoration: none;
  display: inline-block;
}
.link-plain:hover {
  text-decoration: underline;
}
/* Subject truncates earlier due to minmax + ellipsis */
.cell.subject .link-plain {
  font-weight: 600;
  max-width: 100%;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

/* ---------- Badges (center text perfectly) ---------- */
.badge {
  display: inline-flex !important;
  align-items: center;
  justify-content: center; /* center text horizontally */
  height: 20px;
  padding: 0 8px;
  line-height: 1; /* avoid vertical mis-centering */
  border-radius: 999px;
  font-size: 12px;
  border: 1px solid var(--border);
  background: var(--surface-2);
  white-space: nowrap;
}
/* Badges — fully themeable via variables */
.badge.st-open      { background: var(--tone-brand-bg);  color: var(--tone-brand-fg);  border-color: var(--tone-brand-border); }
.badge.st-pending   { background: var(--tone-amber-bg);  color: var(--tone-amber-fg);  border-color: var(--tone-amber-border); }
.badge.st-in_progress{background: var(--tone-blue-bg);   color: var(--tone-blue-fg);   border-color: var(--tone-blue-border); }
.badge.st-on_hold   { background: var(--tone-violet-bg); color: var(--tone-violet-fg); border-color: var(--tone-violet-border); }
.badge.st-solved    { background: var(--tone-green-bg);  color: var(--tone-green-fg);  border-color: var(--tone-green-border); }
.badge.st-closed    { background: var(--tone-gray-bg);   color: var(--tone-gray-fg);   border-color: var(--tone-gray-border); }

/* Priority */
.badge.prio-urgent  { background: var(--tone-red-bg);    color: var(--tone-red-fg);    border-color: var(--tone-red-border); }
.badge.prio-high    { background: var(--tone-amber-bg);  color: var(--tone-amber-fg);  border-color: var(--tone-amber-border); }
.badge.prio-normal  { background: var(--tone-blue-bg);   color: var(--tone-blue-fg);   border-color: var(--tone-blue-border); }
.badge.prio-low     { background: var(--tone-gray-bg);   color: var(--tone-gray-fg);   border-color: var(--tone-gray-border); }

/* SLA */
.badge.sla-ok       { background: var(--tone-green-bg);  color: var(--tone-green-fg);  border-color: var(--tone-green-border); }
.badge.sla-at_risk  { background: var(--tone-amber-bg);  color: var(--tone-amber-fg);  border-color: var(--tone-amber-border); }
.badge.sla-breached { background: var(--tone-red-bg);    color: var(--tone-red-fg);    border-color: var(--tone-red-border); }


/* Updated */
.cell.updated {
  white-space: nowrap;
  font-variant-numeric: tabular-nums;
  padding-right: 6px;
}

/* Row actions (three dots) */
.cell.more {
  display: flex;
  justify-content: center;
  position: sticky;
  right: 0;
}
.iconbtn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 32px;
  height: 32px;
  border-radius: var(--radius-lg);
  border: 1px solid var(--border);
  background: var(--surface-2);
  opacity: .9;
}
.iconbtn:hover {
  background: var(--surface-3);
  opacity: 1;
}
.iconbtn svg {
  width: 18px;
  height: 18px;
  opacity: 0.85;
}

.rowmenu {
  position: absolute;
  right: 6px;
  top: calc(100% + 6px);
  min-width: 160px;
  padding: 6px;
  z-index: 10000 !important;
  border: 1px solid var(--border);
  border-radius: var(--radius-lg);
  background: var(--surface-1);
  box-shadow: var(--shadow-2);
}
.rowmenu__item {
  display: block;
  width: 100%;
  padding: 8px 10px;
  text-align: left;
  border-radius: var(--radius-md);
  background: transparent;
  border: 0;
  color: var(--text);
  cursor: pointer;
}
.rowmenu__item:hover {
  background: var(--surface-2);
}
.rowmenu__sep {
  height: 1px;
  margin: 6px 4px;
  background: var(--border);
}
.rowmenu__item.danger {
  color: #b91c1c;
}
.rowmenu__item.danger:hover {
  background: #fef2f2;
}

/* Empty + footer */
.tbl-body .empty {
  padding: 36px;
  text-align: center;
  color: var(--text-muted);
  font-size: 13px;
}
.tbl-foot {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
  padding: 8px 10px;
  font-size: 13px;
  border-top: 1px solid var(--border);
  background: var(--surface-1);
}
.pager {
  display: inline-flex;
  gap: 6px;
  align-items: center;
}

/* ---------- Filter panel content (unchanged) ---------- */
.filters-side {
  display: grid;
  gap: 10px;
}
.filters-side__title {
  margin: 0 0 8px;
  font-size: 12px;
  color: var(--text-muted);
  text-transform: uppercase;
  letter-spacing: 0.02em;
}

.filters-side__group {
  display: grid;
  gap: 4px;
}
.filters-side__group > label {
  font-size: 11.5px;
  color: var(--text-muted);
}
.filters-side__dates {
  display: grid;
  grid-template-columns: 1fr auto 1fr;
  gap: 6px;
}
.filters-side__dates input[type="date"] {
  height: 34px;
  padding: 6px 10px;
  font-size: 13px;
  border-radius: var(--radius-lg);
  border: 1px solid var(--border);
  background: var(--surface-2);
  color: var(--text);
}
.filters-side__dates .sep {
  align-self: center;
  color: var(--text-muted);
}
.filters-side__actions {
  display: flex;
  gap: 8px;
}

/* ---------- Mobile filter drawer ---------- */
.filterDrawer__backdrop {
  position: fixed;
  inset: 0;
  background: rgba(0, 0, 0, 0.4);
  z-index: 50;
}
.filterDrawer {
  position: fixed;
  top: 0;
  right: 0;
  bottom: 0;
  width: min(88vw, 360px);
  background: var(--surface-1);
  border-left: 1px solid var(--border);
  box-shadow: var(--shadow-2);
  z-index: 51;
  display: grid;
  grid-template-rows: auto 1fr;
  padding: 10px;
}
.filterDrawer__head {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 4px 4px 10px 6px;
  border-bottom: 1px solid var(--border);
}
.filterDrawer__head h4 {
  margin: 0;
  font-size: 14px;
}


.tbl-body::-webkit-scrollbar {
  width: 2px !important;      /* vertical scrollbar width */
  height: 2px !important;     /* horizontal scrollbar height */
}

.tbl-body::-webkit-scrollbar-track {
  background: transparent !important; /* or rgba(0,0,0,0.05) for subtle track */
}

.tbl-body::-webkit-scrollbar-thumb {
  background-color: rgba(0, 0, 0, 0.116) !important;
  border-radius: 4px !important;
}

.tbl-body::-webkit-scrollbar-thumb:hover {
  background-color: rgba(0,0,0,0.45) !important;
}

/* --- Firefox --- */
.tbl-body {
  scrollbar-width: thin !important;              /* makes it thinner */
  scrollbar-color: rgba(0,0,0,0.116) transparent !important;
}


/* --- Let the page section allocate height to the table --- */
.mytickets-root {
  /* topbar + (optional) bulkbar + gaps ~= 170–220px — tweak if needed */
  --chrome-offset: 190px;
  grid-template-rows: auto auto 1fr; /* topbar, bulkbar, main fills */
  min-height: 0;
}
.mytickets-main {
  min-height: 0;
  height: calc(100vh - var(--chrome-offset));
}

/* --- Turn the table panel into a 3-row grid: head | body (scroll) | foot --- */
.mytickets-table {
  display: grid;
  grid-template-rows: auto 1fr auto;
  min-height: 0;            /* allow the middle row to shrink */
  overflow: hidden;         /* the body will own the scroll */
}

/* the scrolling area (vertical) + keep your horizontal scroll */
.tbl-body {
  overflow-y: auto;
  overflow-x: auto;         /* you already use wide grids */
  min-height: 0;
  overscroll-behavior: contain; /* prevent whole-page scroll chaining */
}

/* header stays visible without needing sticky now,
   but if you like the sticky header effect, keep it—both work. */

/* --- Keep filters fixed: sticky sidebar with its own scroll if tall --- */
.mytickets-filterPanel {
  position: sticky;
  top: 10px;                /* distance from top of viewport */
  align-self: start;        /* avoid stretching full height */
  max-height: calc(100vh - 20px);
  overflow: auto;           /* scroll filters if they overflow */
padding: 12px;
  border-radius: var(--radius-xl);
}
/* OPTIONAL: on tablet/phone (when right pane is hidden) nothing to change. */


/* ---------- Responsive: adjust only columns/min-width ---------- */
@media (max-width: 1200px) {
  .mytickets-table {
    --cols: 38px 110px minmax(210px, 1.35fr) 92px 110px 130px 160px 110px 120px
      110px 40px;
    --minw: 1120px;
  }
  .mytickets-main {
    grid-template-columns: minmax(0, 1fr) 300px;
  }
}

@media (max-width: 980px) {
  /* On tablets, we keep columns but allow scroll. Hide right filter pane; show Filters button. */
  .mytickets-table {
    --cols: 38px 108px minmax(200px, 1.2fr) 90px 110px 130px 160px 110px 118px
      110px 40px;
    --minw: 1100px;
  }
  .mytickets-filterPanel {
    display: none;
  }
  .topbar__filtersBtn {
    display: inline-flex;
  }
  .mytickets-main {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 720px) {
  /* Phones: drop some columns + still scroll if needed */
  .mytickets-topbar {
    grid-template-columns: 1fr;
  }
  .mytickets-table {
    --cols: 38px 100px minmax(170px, 1.1fr) 0px 110px 0px 0px 0px 110px 100px
      40px;
    --minw: 900px;
  }
  .cell.prio,
  .cell.assignee,
  .cell.requester,
  .cell.team {
    display: none;
  }
}

/* ---------- Controls + focus ---------- */
input[type="checkbox"] {
  width: 16px;
  height: 16px;
  accent-color: var(--brand);
}
.btn {
  padding: 8px 10px;
  font-size: 13px;
}
:where(.mytickets-root)
  :is(button, .iconbtn, .btn, input, select, .css-13cymwt-control)
  :focus-visible {
  outline: 2px solid var(--brand);
  outline-offset: 2px;
}


/* Hide the columns we don't show on phones — header & rows */
@media (max-width: 720px) {
  .tbl-head .cell.prio,      .row .cell.prio,
  .tbl-head .cell.assignee,  .row .cell.assignee,
  .tbl-head .cell.requester, .row .cell.requester,
  .tbl-head .cell.team,      .row .cell.team {
    display: none !important;
  }

  /* Define ONLY the columns we actually render on phones:
     [checkbox] [ref] [subject] [status] [sla] [updated] [more] */
  .mytickets-table {
    --cols: 38px 100px minmax(180px, 1.4fr) 120px 120px 100px 40px;
    --minw: 720px;                /* horizontal scroll kicks in below this */
  }

  /* Keep the sticky edges subtle, part of table */
  .tbl-head .cell.sel,
  .row .cell.sel {
    position: sticky;
    left: 0;
    z-index: 2;
    background: var(--surface-1);
    border-right: 1px solid var(--border);
    box-shadow: none;
  }
  .tbl-head .cell.more,
  .row .cell.more {
    position: sticky;
    right: 0;
    z-index: 3;
    background: var(--surface-1);
    border-left: 1px solid var(--border);
    box-shadow: none;
  }

  /* When a row menu is open, lift that row above neighbors */
  .tbl-body .row:has(.rowmenu) {
    position: relative;
    z-index: 50;
  }

  /* Subject truncates early to free space */
  .cell.subject .link-plain {
    max-width: 100%;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }
}

